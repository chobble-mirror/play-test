<% if @inspection.errors.any? %>
  <aside>
    <h3>Did not save. Fix these <%= pluralize(@inspection.errors.count, "error") %> and try again:</h3>
    <ul>
    <% @inspection.errors.each do |error| %>
      <li><%= error.full_message %></li>
    <% end %>
    </ul>
  </aside>
<% end %>

<%= form_with(model: @inspection, html: {class: "inspection"}) do |form| %>
  <fieldset>
    <header>
      <h3>Equipment Details</h3>
    </header>

    <%= form.label :unit_id, "Select Unit (Required)" %>
    <%= form.collection_select :unit_id, current_user.units.order(:name), :id, :name, {prompt: "-- Select a unit --"}, {required: true} %>
    
    <% if @inspection.unit.present? %>
      <div style="margin-top: 1em; padding: 1em; background-color: #f5f5f5; border-radius: 4px;">
        <h4>Unit Details</h4>
        <p><strong>Name:</strong> <%= @inspection.unit.name %></p>
        <p><strong>Serial:</strong> <%= @inspection.unit.serial %></p>
        <p><strong>Manufacturer:</strong> <%= @inspection.unit.manufacturer %></p>
      </div>
    <% end %>

    <%= form.label :location, "Location" %>
    <%= form.text_field :location %>
  </fieldset>
  <fieldset>
    <header>
      <h3>Inspection Details</h3>
    </header>

    <%= form.label :inspection_date, "Inspection Date" %>
    <% if current_user.time_display == "day" %>
      <%= form.date_field :inspection_date, value: date_for_form(@inspection.inspection_date) %>
    <% else %>
      <%= form.datetime_local_field :inspection_date, value: date_for_form(@inspection.inspection_date) %>
    <% end %>

    <%= form.label :reinspection_date, "Reinspection Date" %>
    <% if current_user.time_display == "day" %>
      <%= form.date_field :reinspection_date, value: date_for_form(@inspection.reinspection_date) %>
    <% else %>
      <%= form.datetime_local_field :reinspection_date, value: date_for_form(@inspection.reinspection_date) %>
    <% end %>

    <%= form.label :inspector, "Inspector Name" %>
    <%= form.text_field :inspector %>
  </fieldset>
  <fieldset>
    <header>
      <h3>Results</h3>
    </header>

    <%= form.label :passed, "Overall Result" %>
    <%= form.check_box :passed %>
    <label for="inspection_passed">Pass</label>

    <%= form.label :comments, "Comments" %>
    <%= form.text_area :comments, rows: 3 %>
  </fieldset>
  <fieldset>
    <%= form.submit @inspection.new_record? ? "Save Inspection" : "Update Inspection" %>
  </fieldset>
<% end %>
