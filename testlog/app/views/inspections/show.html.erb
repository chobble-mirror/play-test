<article class="view-inspection">
  <header><h2>Inspection Details</h2></header>

  <% if @inspection.unit.nil? %>
    <aside class="notice">
      <h4><%= t("inspections.labels.no_unit") %></h4>
      <p><%= t("inspections.messages.no_unit_description") %></p>
      <%= link_to t("inspections.buttons.create_unit"), new_unit_from_inspection_path(@inspection), class: "button" %>
    </aside>
  <% end %>

  <%= render 'inspection_details', inspection: @inspection %>

  <% if @inspection.comments.present? %>
    <hr>
    <h4>Comments</h4>
    <blockquote>
      <%= simple_format(@inspection.comments) %>
    </blockquote>
  <% end %>

  <hr>

  <%= render 'shared/action_buttons', actions: inspection_actions(@inspection) %>

  <% if content = render('finalization_issues', inspection: @inspection) and content.strip.present? %>
    <hr>
    <%= content.html_safe %>
  <% end %>

  <hr>

  <% if @inspection.status_finalized? %>
    <h4>Report QR Code</h4>
    <%= image_tag qr_code_inspection_path(@inspection), alt: "QR Code for Report", width: 250 %>

    <hr>

    <h4>Report PDF Link</h4>
    <%= link_to short_report_url(@inspection), short_report_url(@inspection) %>

    <hr>

    <h4>Inspection Report</h4>
    <iframe src="<%= inspection_path(@inspection, format: :pdf) %>" 
            width="100%" 
            height="800px" 
            style="border: 1px solid #ccc;">
      Your browser does not support PDFs. 
      <%= link_to "Download the PDF", inspection_path(@inspection, format: :pdf) %>.
    </iframe>
  <% else %>
    <div class="notice">
      <h4>Report Availability</h4>
      <p>QR Code and PDF available once the test has been finalised.</p>
    </div>
  <% end %>
</article>
