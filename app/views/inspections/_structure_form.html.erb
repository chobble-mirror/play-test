<%= render 'form/form_context', model: @inspection.structure_assessment, i18n_base: 'forms.structure', url: inspection_structure_assessment_path(@inspection) do |form| %>

    <div class="assessment-form structure-assessment">

      <!-- Critical Safety Checks Section -->
      <%= render 'form/fieldset', legend_key: 'critical_safety_checks' do %>
        <%= render 'form/pass_fail', field: :seam_integrity_pass %>
        <%= render 'form/pass_fail', field: :lock_stitch_pass %>
        <%= render 'form/pass_fail', field: :air_loss_pass %>
        <%= render 'form/pass_fail', field: :straight_walls_pass %>
        <%= render 'form/pass_fail', field: :sharp_edges_pass %>
        <%= render 'form/pass_fail', field: :unit_stable_pass %>
      <% end %>

      <!-- Measurements Section -->
      <%= render 'form/fieldset', legend_key: 'measurements' do %>
        <div class="form-group">
          <%= render 'form/number', field: :stitch_length, min: 0, step: 0.1 %>
          <%= render 'form/pass_fail', field: :stitch_length_pass %>
        </div>

        <div class="form-group">
          <%= render 'form/number', field: :evacuation_time, min: 0, step: 1 %>
          <%= render 'form/pass_fail', field: :evacuation_time_pass %>
        </div>

        <div class="form-group">
          <%= render 'form/number', field: :unit_pressure_value, min: 0, step: 0.1 %>
          <%= render 'form/pass_fail', field: :unit_pressure_pass %>
        </div>

        <div class="form-group">
          <%= render 'form/number', field: :blower_tube_length, min: 0, step: 0.1 %>
          <%= render 'form/pass_fail', field: :blower_tube_length_pass %>
        </div>
      <% end %>

      <!-- Additional Safety Checks Section -->
      <%= render 'form/fieldset', legend_key: 'additional_safety_checks' do %>
        <div class="form-group">
          <%= render 'form/number', field: :step_size_value, min: 0, step: 0.1 %>
          <%= render 'form/pass_fail', field: :step_size_pass %>
        </div>

        <div class="form-group">
          <%= render 'form/number', field: :fall_off_height_value, min: 0, step: 0.1 %>
          <%= render 'form/pass_fail', field: :fall_off_height_pass %>
        </div>

        <div class="form-group">
          <%= render 'form/number', field: :trough_depth_value, min: 0, step: 0.1 %>
          <%= render 'form/number', field: :trough_width_value, min: 0, step: 0.1 %>
          <%= render 'form/pass_fail', field: :trough_pass %>
        </div>

        <%= render 'form/pass_fail', field: :entrapment_pass %>
        <%= render 'form/pass_fail', field: :markings_pass %>
        <%= render 'form/pass_fail', field: :grounding_pass %>
      <% end %>

      <!-- Critical Failures Summary -->
      <% if @inspection.structure_assessment&.persisted? && @inspection.structure_assessment.has_critical_failures? %>
        <div class="critical-failures text-danger">
          <strong><%= t('forms.structure.summary.critical_failures') %>:</strong>
          <%= @inspection.structure_assessment.critical_failure_summary %>
        </div>
      <% end %>

      <!-- Safety Status -->
      <%= render 'form/assessment_status', assessment: @inspection.structure_assessment %>

    </div>
<% end %>
