<%
  # Unified unit photo partial - always shows default size (800px) and links to full size
  # Required locals: unit (Unit object with potential photo attachment)
  # Optional locals: show_caption (boolean, defaults to true)
  
  unit = local_assigns[:unit]
  show_caption = local_assigns.fetch(:show_caption, true)
  
  return unless unit&.photo&.attached? && unit.photo.blob.persisted?
  
  alt_text = t('units.messages.photo_of', name: unit.name)
%>

<div class="unit-photo">
  <%= link_to rails_blob_path(ImageProcessorService.full_size(unit.photo), disposition: "inline") do %>
    <%= render 'shared/image',
        image: unit.photo,
        size: :default,
        alt: alt_text %>
    <% if show_caption %>
      <p><small><%= t('units.messages.view_full_photo') %></small></p>
    <% end %>
  <% end %>
</div>